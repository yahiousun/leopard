!function(a){"use strict";var b=function(a,c){return new b.prototype.init(a,c)};b.prototype={constructor:b,resources:[],loaded:[],failed:[],completed:!1,aborted:!1,timer:null,init:function(a,c){"string"==typeof a&&(a=[a]),this.resources=a,this.options=c||b.defaults,this.preload()},preload:function(){var a=this,c=0;for(a.options.timeout,a.options.failback&&typeof("function"===a.options.failback)&&(a.timer=setTimeout(function(){a.options.failback(a)},a.options.timeout)),a.options.onloadstart&&a.options.onloadstart(a);c<a.resources.length;c++)if("string"==typeof a.resources[c]){if("image"===a.options.type||"audio"===a.options.type||"video"===a.options.type)a.process(a.resources[c],a.options.type);else if("auto"===a.options.type){var d=a.resources[c].substring(a.resources[c].lastIndexOf(".")+1).toLowerCase();b.mime[d]?a.process(a.resources[c],b.mime[d]):a.fail(a.resources[c],"2")}}else"object"==typeof a.resources[c]?!a.resources[c].url||"image"!==a.resources[c].type&&"audio"!==a.resources[c].type&&"video"!==a.resources[c].type?a.fail(a.resources[c],"1"):a.process(a.resources[c].url,a.resources[c].type):a.fail(a.resources[c],"1")},process:function(b,c){var d,e=this;return e.aborted?!1:void("image"===c?(d=a.createElement("img"),d.addEventListener("load",function(){e.progress(b),d=null},!1),d.addEventListener("error",function(){e.fail(b,"0"),d=null},!1),d.src=b,d.complete&&(e.progress(b),d=null)):"audio"===c?(d=a.createElement("audio"),d.addEventListener("canplaythrough",function(){e.progress(b),d=null},!1),d.addEventListener("error",function(){e.fail(b,"0"),d=null},!1),d.src=b,d.preload="auto"):"video"===c&&(d=a.createElement("video"),d.addEventListener("canplaythrough",function(){e.progress(b),d=null},!1),d.addEventListener("error",function(){e.fail(b,"0"),d=null},!1),d.src=b,d.preload="auto"))},progress:function(a){var b=this;return b.aborted?!1:(b.loaded.push(a),b.options.onprogress&&"function"==typeof b.options.onprogress&&b.options.onprogress(b),void b.complete())},fail:function(a,c){var d=this,e={url:a,code:c,msg:b.fail[c]};return d.aborted?!1:(d.options.onerror&&"function"==typeof d.options.onerror&&d.options.onerror(e,d),d.failed.push(a),void d.complete())},abort:function(){var a=this;a.aborted=!0},complete:function(){var a=this;return a.completed instanceof Boolean&&a.completed&&a.loaded.length+a.failed.length===a.resources.length?!0:void(a.loaded.length+a.failed.length===a.resources.length&&(a.completed=!0,a.options.onload&&"function"==typeof a.options.onload&&0===a.failed.length&&a.options.onload(),a.options.onloadend&&a.options.onloadend(a)))}},b.prototype.init.prototype=b.prototype,b.defaults={type:"auto",timeout:0,failback:null},b.mime={bmp:"image",gif:"image",jpg:"image",png:"image",svg:"image",m4a:"audio",mp3:"audio",oga:"audio",ogg:"audio",opus:"audio",wav:"audio",weba:"audio",mp4:"video",m4v:"video",ogv:"video",webm:"video"},b.fail={0:"Unkonwn error.",1:"Unknown source type.",2:"Unsupported source mime type."},"function"==typeof define&&define.amd?define("leopard",[],function(){return b}):window.leopard=b}(document);